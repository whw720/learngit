<!DOCTYPE HTML>
<html>
<head>
    <title><%= title %></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="lib/bootstrap/js/jquery.min.js"></script>
    <script type="text/javascript">
        var webRoot = '<%=webRoot%>';
        if(typeof JSON == 'undefined'){$('head').append($("<script type='text/javascript' src='lib/bootstrap/js/json2.js'>"));}
    </script>
</head>


<body>

<script type="text/javascript">
    var userInfo = '<%=userInfo%>';
    var webRoot = '<%=webRoot%>';
    var username="";

    $(document).ready(function () {
        if(userInfo==='undefined'){
        }else{
            //已登录
            userInfo = userInfo.replace(/&quot;/g,'"');
            userInfo = JSON.parse(userInfo);
            $("input#id").val(userInfo.id);
            $("input#name").val(userInfo.name);
            $("input[name='gender'][value="+userInfo.gender+"]").attr("checked",true);
            $("input#phone").val(userInfo.phone);
            $("input#grade").val(userInfo.grade);
            $("input#school").val(userInfo.school);
            $("input[name='compet'][value="+userInfo.compet+"]").attr("checked",true);
        }
        $("#btnAjaxSubmit").click(function () {
            var options = {
                url: webRoot+'/update',
                type: 'post',
                dataType: 'text',
                data: $("#form1").serialize(),
                success: function (data) {
                    var result=JSON.parse(data);
                    if (result.data.update){
                        alert('更新成功');
                        $("input[type=reset]").trigger("click");
                        window.location.href=webRoot+'/welcome';
                    }else{
                        alert('更新失败，该用户名和电话已经被占用');
                    }
                }
            };
            $.ajax(options);
            return false;
        });
    });
</script>
<div class="commPage register" >
<form id="form1" method="post">
    <table border="0" class="loginTable" style="width:300px;padding-top: 140px;padding-left: 550px;">
        <tr>
            <td><div style="width: 70px;">姓名：</div></td>
            <td><div style="width: 230px;">
                <input type="text" name="name" id="name" />
            <input type="hidden" name="id" id="id" value="" /></div></td>
        </tr>
        <tr>
            <td>性 别：</td>
            <td>
                <input type="radio" name="gender" id="gender" value="1"  style="width: 25px;height: 20px;"/>男&nbsp;&nbsp;
                <input type="radio" name="gender" id="gender" value="0"  style="width: 25px;height: 20px;"/>女
            </td>
        </tr>
        <tr>
            <td>联系方式：</td>
            <td>
                <input type="text" name="phone" id="phone" /></td>
        </tr>
        <tr>
            <td>年级：</td>
            <td>
                <input type="text" name="grade" id="grade" /></td>
        </tr>
        <tr>
            <td>学校：</td>
            <td>
                <input type="text" name="school" id="school" /></td>
        </tr>
        <tr>
            <td>报名比赛：</td>
            <td>
                <input type="radio" name="compet" id="compet" value="1"  style="width: 25px;height: 20px;"/>小低组
                <input type="radio" name="compet" id="compet" value="2"  style="width: 25px;height: 20px;"/>小高组
                <input type="radio" name="compet" id="compet" value="3"  style="width: 25px;height: 20px;"/>初中组
            </td>
        </tr>
        <tr>
            <td colspan="2" style="text-align: center">
                <div style="color: gray;font-size: 12px;padding-left: 10px;padding-top: 10px;height: 40px;">
                    提示: 小低组(2—4年级);小高组(5—6年级);初中组(7—9年级 也称初一到初三)</div>
            </td>
        </tr>
        <tr>
            <td colspan="2" style="text-align: center">
                <input id="btnAjaxSubmit" type="submit" value="更改信息" style="width: 80px;" />
                <input type="reset" style="display:none;" />&nbsp;&nbsp;&nbsp;&nbsp;
                <input type="button" value="返回" style="width: 80px;" onclick="javascript:history.back(-1);">
            </td>
        </tr>
    </table>
</form>
<label id="responseText"></label>
    </div>
</body>

</html>